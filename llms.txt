# Design System Extractor

> A Figma plugin + local server + Claude Code skill that extracts complete design systems from Figma files and converts them into `.designrules` files — a universal, platform-agnostic format any AI agent can use to build UI for any platform (web, iOS, Android, Flutter).

## What This Project Does

This tool extracts design tokens, components, and layouts from Figma and produces a structured `.designrules` file. The entire pipeline runs locally with zero external API calls.

The pipeline: Figma plugin extracts JSON → localhost:9876 server saves to disk → Claude Code `/design-system` skill generates `.designrules`.

## Architecture

Three components:

1. **Figma Plugin** (`plugin/`): Runs in Figma's sandbox, walks the document tree, extracts colors, typography, spacing, effects, components (with variants and properties), variables (with modes), styles, and frame layouts. Sends structured JSON to localhost.

2. **Local Server** (`server.js`): Zero-dependency Node.js HTTP server on port 9876. Receives POST to `/extract`, saves JSON to `~/.design-systems/<name>.json` and `./design-system.json`. CORS enabled for Figma plugin iframe access.

3. **Claude Code Skill** (`skill/design-system.md`): Installed as `/design-system` slash command. Reads extracted JSON, generates `.designrules` file with design tokens, component pseudo-XML, frame layouts, and platform mappings (CSS, SwiftUI, Jetpack Compose, Flutter).

## Key Files

- [plugin/code.js](plugin/code.js): Main extraction logic — `extractColors()`, `extractTypography()`, `extractEffects()`, `extractVariables()`, `extractComponents()`, `extractFrames()`. Uses `walkNodes()` with configurable depth limits.
- [plugin/manifest.json](plugin/manifest.json): Figma plugin manifest with `networkAccess.allowedDomains` set to `localhost:9876`.
- [plugin/ui.html](plugin/ui.html): Plugin UI with Extract button, progress states, and stats display.
- [server.js](server.js): HTTP server, ~50 lines, handles POST `/extract` with JSON body, saves to two locations.
- [skill/design-system.md](skill/design-system.md): Claude Code slash command prompt defining the `.designrules` output format.
- [install.sh](install.sh): Copies skill to `~/.claude/commands/`, creates `~/.design-systems/`.

## Extracted JSON Schema

The plugin outputs JSON with this structure:

```
{
  fileName: string,
  extractedAt: ISO date string,
  stats: { colors, textStyles, components, variables, effects, frames },
  colors: [{ name, hex, rgba: {r,g,b,a}, type: "solid"|"gradient_linear"|"gradient_radial", stops? }],
  typography: [{ name, fontFamily, fontWeight, fontSize, lineHeight, letterSpacing, textDecoration, textCase }],
  effects: [{ name, effects: [{ type, color, opacity, offset, radius, spread }] }],
  styles: { grids: [{ name, grids: [{ pattern, sectionSize, gutterSize, count }] }] },
  variables: [{ name, collection, type, modes: { modeName: value } }],
  components: [{ name, description, type, width, height, properties?, variants?, children?, layout? }],
  frames: [{ name, page, width, height, layout?, fills, cornerRadius, children }]
}
```

## .designrules Output Format

The generated `.designrules` file contains:
- **Tokens**: Colors, typography, spacing scale, effects, variables with modes
- **Components**: Pseudo-XML describing structure, layout direction, spacing, padding, fills, corner radius, and text styles
- **Frames**: Top-level screen/page layouts as pseudo-XML
- **Platform Mapping**: Token equivalents for CSS custom properties, SwiftUI, Jetpack Compose, and Flutter

## Setup

```bash
git clone https://github.com/minkuodis/figma-design-extract.git
cd figma-design-extract
./install.sh
```

Then: import `plugin/manifest.json` in Figma Desktop, run `node server.js`, use the plugin to extract, run `/design-system` in Claude Code.

## Optional

- [LICENSE](LICENSE): MIT license
- [package.json](package.json): Node.js package metadata (no dependencies)
